---
title: 技术架构规范总结
date: 2016-5-11 18:38:31
tags:
    - Architecture
    - Specification
categories:
    - Summary
description: 总结技术架构方面的普适性经验，还有一些团队管理的准则。
---

# 原则

## 命名规范
### 重要性

以SystemTap火焰图举例

### 如何做？

参考：[Google Java Style](http://blog.csdn.net/yzmyyff/article/details/45243261)

### 约定优于配置

## 合理的设计
### 适时分层
### 避免过度设计
### 模块化设计
模块化设计在重构时，可以将影响降到最低。达到低风险、低成本。
模块化设计对系统快速构建是一个阻碍，它要求将可预见的同类型代码复用，内聚到一个模块中。

## 前轻后重
系统之间的调用链，前置系统轻逻辑。
### 上轻下重，核心逻辑内敛
模块之间的调用链，上层模块轻逻辑


## 基础优先
在构建软件时，保持基础组件优先稳定下来，定义好对外接口，并保留可扩展性。
例如安全性设计，在后期加比在前期加的成本高很多。

## 最小冗余
### 代码保持最少行数
1.少一行代码，就少了一个潜在的bug
2.行数少了，往往意味着重用性高了
3.不要过度牺牲可读性


## 保持简单
### 简单意味着快速
### 简单意味着灵活
### 简单意味着易扩展
### 简单意味着易重构

## Fast fail

## 代码即文档
### 合理的注释

## 关键业务设计宣讲
### 保持一致的看法

## 小步快走
### 意味着版本迭代快速
### 意味着版本迭代稳定
### 意味着部署回滚成本低

# 重构与优化
## 紧急优先
优先对紧急需要改进的部分进行重构
## 计划性的重构
在敏捷开发时，往往时间不够，有些模块只能以非优雅的方式构建。但是需要在这些模块加上TODO以免重构时遗忘。
## 时机
团队一致认为模块维护成本高昂时，果断重构。
## 基于成本的优化

CBO(Cost base optimize)

引用数据库查询分析计划来说明：[如果有人问你数据库的原理，叫他看这篇文章#查询优化器](http://blog.jobbole.com/100349)

## 数据支撑
给出重构前后的成本与收益报告
## 持续性
在时间不够或时机不成熟时，分阶段的进行

# 技术选型
## 开源优先
## 稳定优先
## 掌控度高优先
## 保留备选项
## 只有合适的技术，没有最好的技术。
## 避免一招鲜吃遍天
手里有锤子，看到什么都觉得像钉子
## 技术升级
系统容量与性能指标的要求，在业务发展的各个阶段是不固定的，技术需要保留一定前瞻性，不做被动跟随。

# 团队管理
## keep watch
工作与心理的交流分享
## 保持信任
## 保持怀疑
## 持续考评
## 分享中提高


有一个著名的理论，叫木桶理论。意思是木桶能装多少水，是由木桶最短的那个板来决定的。团队也是如此。团队的力量有多大，很多时候也是由能力最差的那个成员来决定的。为了提高团队整体的实力，我们必须提高每个人的能力。我们的改善必须得是可度量的，所以我们也要数字化能力的标准。


## 提高工作效率

其实很多团队都在进行着这个工作。最常见的就是会做一些小工具，来节省我们的时间。比如代码自动生成工具，自动打包工具，自动的比较工具等等。我们应该制作尽可能多的自动化工具，来解放我们的时间。

为了让大家投入更多的热情来制作各种工具，团队可以制定一定的奖励规则，对制作工具的人给予奖励。

公司要把最好的人才放到工具开发那一块，因为工具做好了，可以达到事半功倍的效果，所有人的效率都可以得到提高，而不仅仅是工程师。

## 互相备份
## 互相支撑
## 向上管理
## 向下管理
### 了解队员的擅长与不足
### 合理的任务分配
### 适度挑战性的任务
### 给出完成任务需要的资源
### 激励中成长
眼前利益与发展前景
### 给出职业发展的机会
### 公开与公平中考评
### 保持团队稳定
团队成员的诉求：团队，产品，薪资，发展。

团队提供集体成长的氛围环境。

令人兴奋的产品，提供持续打磨的动力。

合适的薪资，使个人不过多为生活所扰。

良好的发展前景，对个人的职业生涯带来腾飞。

“穷得只剩钱”。小公司对企业文化不慎重视，开发团队的整体风气也没要求，招人过来只求出活，对团队个人发展是零投入的态度。这样的企业要想招到人、留住人，只剩钱了，但个人发展到一定高度，往往企业再也给不出足够的钱，这时再想留住人就很难了。这就是企业只依靠薪资吸引人带来的问题，对其他人才诉求不重视，穷得只剩钱。

## 适时剔除不合格
## 技术梯队
不同层次的人员配比，完成不同类型的任务。注意人员的上升下降渠道。

# 接口
## 版本控制
## 访问控制
访问权限的验证
## 流量控制
拒绝恶意访问
## 审查与监控
## 灰度发布
## 无状态
## 原子化
## CQRS
命令查询职责分离模式，读不强依赖写。


# APP(Client)
## 远程控制权
## 展示为主
## 少的逻辑
## 适度安全

# 部署
## 监控
## 降低升级时间窗
## 没有人需要等待
正式发布后，对于任何用户都是公平使用的。不需要牺牲部分用户利益。
常见于缓存autowarm时需要阻塞第一批到达的用户。
## 提前消除隐患



# Reference

* [以Facebook为案例剖析科技公司应有的工具文化](http://blogread.cn/it/article/7346?f=wb&utm_source=top.caibaojian.com/102758)